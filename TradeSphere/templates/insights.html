<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insights</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/insights.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header Section -->
    <div class="header-section">
        <div class="header-left">
            <img src="{{ url_for('static', filename='img/full-logo-tp.png') }}" alt="Logo">
        </div>
        <div class="header-mid">
            <h1>Market Insights & Analytics</h1>
        </div>
        <div class="header-right">
            <i class="fa-solid fa-bell"></i>
            <a href="{{ url_for('serve_wallet') }}"></a><button class="deposit-button">Deposit</button></a>
        </div>
    </div>
    
    <!-- Left Sidebar --> 
    <div class="sidebar">
        <div class="search-bar">
            <input type="text" placeholder="Search">
        </div>
        <ul class="nav-links">
            <li><a href="{{ url_for('serve_dashboard') }}"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="{{ url_for('serve_wallet') }}"><i class="fas fa-wallet"></i> Wallet</a></li>
            <li><a href="{{ url_for('serve_trade') }}"><i class="fas fa-exchange-alt"></i> Trade</a></li>
            <li><a href="{{ url_for('serve_community') }}"><i class="fas fa-users"></i> Community</a></li>
            <li><a href="{{ url_for('serve_insights') }}" class="active"><i class="fas fa-chart-line"></i> Insights</a></li>
            <li><a href="{{ url_for('serve_settings') }}"><i class="fas fa-cog"></i> Settings</a></li>
        </ul>
        <div class="logout-container">
            <button class="logout-btn" onclick="logout()">
                <i class="fa-solid fa-right-from-bracket" style="color: #ff0040;"></i> Logout
            </button>
        </div>
    </div>
    <script>
        function logout() {
            fetch('/logout', { method: 'POST' }) // Send a POST request to the logout route
            .then(response => {
                if (response.redirected) {
                    window.location.href = response.url;  // Redirect to home after logout
                }
            })
            .catch(error => console.error('Logout Error:', error));
        }
        </script>

    <!-- Main Content Section -->
    <main>
        <div class="container">
            <!-- Crypto Cards Section -->
            <div class="crypto-cards" id="crypto-cards">
                <div class="crypto-card" id="eth-card">
                    <h3>Ethereum</h3>
                    <p id="eth-amount">0.00 ETH</p>
                    <p id="eth-price">$0.00</p>
                </div>
                <div class="crypto-card" id="btc-card">
                    <h3>Bitcoin</h3>
                    <p id="btc-amount">0.00 BTC</p>
                    <p id="btc-price">$0.00</p>
                </div>
                <div class="crypto-card" id="usdt-card">
                    <h3>Tether</h3>
                    <p id="usdt-amount">0.00 USDT</p>
                    <p id="usdt-price">$0.00</p>
                </div>
                <div class="crypto-card" id="doge-card">
                    <h3>Dogecoin</h3>
                    <p id="doge-amount">0.00 DOGE</p>
                    <p id="doge-price">$0.00</p>
                </div>
            </div>

            <!-- Chart Section -->
            <section class="chart-section">
                <h2>Bitcoin Price History</h2>
                <canvas id="btcChart" width="400" height="200"></canvas>
            </section>

            <!-- Market Share Pie Chart Section -->
            <section class="pie-chart-section">
                <h2>Cryptocurrency Market Share</h2>
                <canvas id="marketShareChart" width="400" height="400"></canvas>
            </section>

            <!-- Market Overview Section -->
            <section class="market-overview">
                <h2>Market Overview</h2>
                <div class="overview-card">
                    <h3>Total Market Cap</h3>
                    <p id="market-cap">$0.00</p>
                </div>
                <div class="overview-card">
                    <h3>24h Trading Volume</h3>
                    <p id="24h-volume">$0.00</p>
                </div>
            </section>

            <!-- Analysis Section -->
            <section class="analysis-section">
                <h2>Coin Performance Analysis</h2>
                <div class="analysis-card">
                    <h3>Bitcoin (BTC)</h3>
                    <p id="btc-analysis">Bitcoin has been on a bullish trend over the last 24 hours, with a 5% increase in price.</p>
                </div>
                <div class="analysis-card">
                    <h3>Ethereum (ETH)</h3>
                    <p id="eth-analysis">Ethereum has been stable, showing slight fluctuations but holding steady around the $1500 mark.</p>
                </div>
                <div class="analysis-card">
                    <h3>Tether (USDT)</h3>
                    <p id="usdt-analysis">Tether remains stable, pegged to the US Dollar with minimal price fluctuation.</p>
                </div>
                <div class="analysis-card">
                    <h3>Dogecoin (DOGE)</h3>
                    <p id="doge-analysis">Dogecoin has experienced a slight decrease, currently down by 3% in the past 24 hours.</p>
                </div>
                <div class="analysis-card">
                    <h3>Cardano (ADA)</h3>
                    <p id="ada-analysis">Cardano has gained 8% over the last 24 hours, following a major update to its network.</p>
                </div>
                <div class="analysis-card">
                    <h3>Binance Coin (BNB)</h3>
                    <p id="bnb-analysis">Binance Coin has seen a steady rise, up by 6% due to recent developments in the Binance exchange.</p>
                </div>
                <div class="analysis-card">
                    <h3>Solana (SOL)</h3>
                    <p id="sol-analysis">Solana has shown a major bounce back, up by 10% after resolving some network issues.</p>
                </div>
                <div class="analysis-card">
                    <h3>Polkadot (DOT)</h3>
                    <p id="dot-analysis">Polkadot has been on a slight decline, down by 2% over the past week, but still holds strong long-term potential.</p>
                </div>
                <div class="analysis-card">
                    <h3>Litecoin (LTC)</h3>
                    <p id="ltc-analysis">Litecoin is showing moderate growth, with a 4% increase in price in the last 24 hours.</p>
                </div>
                <div class="analysis-card">
                    <h3>Chainlink (LINK)</h3>
                    <p id="link-analysis">Chainlink has shown strong growth, up by 12% after securing several major partnerships.</p>
                </div>
            </section>
            
        </div>
    </main>

    <script>
        // Function to log out user
        function logout() {
            fetch('/logout', { method: 'POST' })
            .then(response => {
                if (response.redirected) {
                    window.location.href = response.url;
                }
            })
            .catch(error => console.error('Logout Error:', error));
        }

        // Fetch Market Data from CoinGecko API
        function fetchMarketData() {
            fetch('https://api.coingecko.com/api/v3/simple/price?ids=ethereum,bitcoin,tether,dogecoin&vs_currencies=usd')
            .then(response => response.json())
            .then(data => {
                // Update the coin prices dynamically
                document.getElementById('btc-price').innerText = '$' + data.bitcoin.usd;
                document.getElementById('eth-price').innerText = '$' + data.ethereum.usd;
                document.getElementById('usdt-price').innerText = '$' + data.tether.usd;
                document.getElementById('doge-price').innerText = '$' + data.dogecoin.usd;

                // Set the amount of coins (replace with actual wallet data)
                document.getElementById('eth-amount').innerText = '1.25 ETH'; // Example ETH amount
                document.getElementById('btc-amount').innerText = '0.65 BTC'; // Example BTC amount
                document.getElementById('usdt-amount').innerText = '5000.00 USDT'; // Example USDT amount
                document.getElementById('doge-amount').innerText = '25000.00 DOGE'; // Example DOGE amount

                // Set Market Overview Data
                document.getElementById('market-cap').innerText = '$' + (data.bitcoin.usd * 100000); // Example Market Cap
                document.getElementById('24h-volume').innerText = '$' + (data.bitcoin.usd * 5000); // Example Trading Volume
            })
            .catch(error => console.error('Error fetching market data:', error));
        }

        // Fetch Bitcoin Price History for Chart
        function fetchPriceHistory() {
            fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=7')
            .then(response => response.json())
            .then(data => {
                const labels = data.prices.map(price => new Date(price[0]).toLocaleDateString());
                const prices = data.prices.map(price => price[1]);

                const ctx = document.getElementById('btcChart').getContext('2d');
                const btcChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Bitcoin Price (USD)',
                            data: prices,
                            borderColor: '#FFC100',
                            borderWidth: 2,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                });
            })
            .catch(error => console.error('Error fetching price history:', error));
        }

        // Fetch Cryptocurrency Market Share for Pie Chart
        function fetchMarketShare() {
            fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=bitcoin,ethereum,tether,dogecoin,cardano&order=market_cap_desc')
            .then(response => response.json())
            .then(data => {
                const labels = data.map(coin => coin.name);
                const marketShares = data.map(coin => coin.market_cap);

                const ctx = document.getElementById('marketShareChart').getContext('2d');
                const marketShareChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Market Share (USD)',
                            data: marketShares,
                            backgroundColor: ['#FF0000', '#0000FF', '#00FF00', '#FF9900', '#9900FF'],
                        }]
                    },
                    options: {
                        responsive: true,
                    }
                });
            })
            .catch(error => console.error('Error fetching market share data:', error));
        }

        // Initial calls to load data
        fetchMarketData();
        fetchPriceHistory();
        fetchMarketShare();
    </script>
    <!-- Footer -->
<footer>
    <div class="footer-container">
    <!-- Navigation Links -->
        <div class="footer-links">
            <a href="{{ url_for('serve_home') }}">Home</a>
            <a href="{{ url_for('serve_about') }}">About</a>
            <a href="#">Contact</a>

        </div>
    <!-- Email Subscription -->
        <div class="subscribe-section">
            <p>Stay up to date</p>
            <form>
                <input type="email" placeholder="Enter your email" />
                <button type="submit">Subscribe</button>
            </form>
        </div>
    <!-- Bottom Legal Links -->
        <div class="footer-bottom">
            <p>© 2025 TradeSphere. All rights reserved.</p>
            <div class="legal-links">
                <a href="#">Terms</a>
                <a href="#">Privacy</a>
            </div>
        </div>
</div>
</footer>
</body>
</html>
